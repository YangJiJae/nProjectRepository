# _CD  코드성 컬럼
# REG_DT_TM 데이터 인서트 시간
#
#

# 매장고객 정보 테이블 COMPANY
DROP TABLE IF EXISTS COMPANY; 
CREATE TABLE COMPANY
(
  COM_ID VARCHAR(100) NOT NULL COMMENT '업체 아이디' ,
  PWD VARCHAR(100) NOT NULL COMMENT '비밀번호' ,
  JOIN_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '가입 일시' ,
  PHONE_NUM VARCHAR(20) COMMENT '핸드폰 번호' ,
  EMAIL VARCHAR(20) COMMENT '이메일' ,
  NAME VARCHAR(50) COMMENT '성명' ,
  COM_NM VARCHAR(100) COMMENT '회사명' ,
  ADDRESS VARCHAR(200) COMMENT '주소' ,
  DTAIL_ADDRESS VARCHAR(100) COMMENT '상세주소' ,
  TEL_NUM VARCHAR(20) COMMENT '전화번호' ,
  COM_ID_CERT_YN VARCHAR(2) COMMENT '업체 아이디 인증 여부' ,
  CERT_DT_TM TIMESTAMP DEFAULT NULL COMMENT '인증 일시' ,
  LEAVE_REASON VARCHAR(500) COMMENT '탈퇴 사유' ,
  LEAVE_DT_TM TIMESTAMP DEFAULT NULL COMMENT '탈퇴 일시' ,
  USE_YN VARCHAR(2) COMMENT '사용 여부' ,
  REG_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록 일시' ,
  CONSTRAINT COMPANY_PK PRIMARY KEY (COM_ID)
) COMMENT ='매장고객 정보 테이블' ;

# 매장 설정 정보
DROP TABLE IF EXISTS RESTAURANT; 
CREATE TABLE RESTAURANT
(
  COM_ID VARCHAR(100) NOT NULL COMMENT '업체 아이디' ,
  DEMAND_CD VARCHAR(2)  COMMENT '식사위치 01,02,03' , 
  WORK_SUN VARCHAR(8) COMMENT '' , # 08002000 -> 0800 ~ 2000
  WORK_MON VARCHAR(8) COMMENT '' ,
  WORK_TUE VARCHAR(8) COMMENT '' ,
  WORK_WED VARCHAR(8) COMMENT '' ,
  WORK_THU VARCHAR(8) COMMENT '' ,
  WORK_FIR VARCHAR(8) COMMENT '' ,
  WORK_SAT VARCHAR(8) COMMENT '' ,
  DISCOUNT_YN VARCHAR(2) COMMENT '할인 여부' ,
  ACCUMULATION_YN VARCHAR(2) COMMENT '적립 여부' ,
  DELIVERTY_COST INT DEFAULT 0 COMMENT '배달 비용' ,
  AD_WORD VARCHAR(500) COMMENT '매장 문구' ,
  REG_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록 일시' ,
  CONSTRAINT RESTAURANT_PK PRIMARY KEY (COM_ID)
) COMMENT ='매장 설정 정보' ;

# 할인 정보
DROP TABLE IF EXISTS DISCOUNT; 
CREATE TABLE DISCOUNT
(
  COM_ID VARCHAR(100) NOT NULL COMMENT '업체 아이디' ,
  MENU_CD VARCHAR(8) COMMENT '메뉴 코드' ,
  MENU_NM VARCHAR(100) COMMENT '메누명' ,
  ORIGINAL_PRICE INT COMMENT '원가' ,
  MIN_PRICE INT COMMENT '최소 금액' ,
  DISCOUNT_CD VARCHAR(2) COMMENT '할인 코드 01:%할인, 02:금액할인' , # "1": %할인, "2": 1000원 할인
  DISCOUNT INT COMMENT '' ,
  CNT INT COMMENT '품목 개수' ,
  REG_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록 일시' ,
  CONSTRAINT DISCOUNT_PK PRIMARY KEY (COM_ID,MENU_CD)
) COMMENT ='할인 정보' ;

# 적립 정보
DROP TABLE IF EXISTS ACCUMULATION; 
CREATE TABLE ACCUMULATION
(
  COM_ID VARCHAR(100) NOT NULL COMMENT '업체 아이디' ,
  MENU_CD VARCHAR(8) COMMENT '메뉴 코드' ,
  MENU_NM VARCHAR(100) COMMENT '메뉴명' ,
  ORIGINAL_PRICE INT COMMENT '원가' ,
  MIN_PRICE INT COMMENT '최소 금액' ,
  ACCUMULATION_CD VARCHAR(2) COMMENT '할인 코드 01:%할인, 02:금액할인' , # "1": %할인, "2": 1000원 할인
  ACCUMULATION INT COMMENT '' ,
  CNT INT COMMENT '품목 개수' ,
  REG_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록 일시' ,
  CONSTRAINT ACCUMULATION_PK PRIMARY KEY (COM_ID,MENU_CD)
) COMMENT ='적립 정보' ;

# 메뉴 정보
DROP TABLE IF EXISTS MENU; 
CREATE TABLE MENU
(
  COM_ID VARCHAR(100) NOT NULL COMMENT '업체 아이디' ,
  GROUP_CD VARCHAR(4) COMMENT '그룹 코드' ,
  MENU_CD VARCHAR(8)  COMMENT '메뉴 코드' , 
  MENU_NM VARCHAR(100) COMMENT '메뉴명' ,
  PRICE INT COMMENT '가격' ,
  SELL_YN VARCHAR(2) COMMENT '판매여부' , #판매여부,품절여부
  IMG_PATH VARCHAR(100) COMMENT '이미지경로' ,
  OPTION_YN VARCHAR(2) COMMENT '옵션 여부' ,
  REG_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록 일시' ,
  CONSTRAINT MENU_PK PRIMARY KEY (COM_ID,MENU_CD)
) COMMENT ='메뉴 정보' ;

# 메뉴 옵션 설정
DROP TABLE IF EXISTS MENU_OPT; 
CREATE TABLE MENU_OPT
(
  COM_ID VARCHAR(100) NOT NULL COMMENT '업체 아이디' ,
  MENU_CD VARCHAR(8) COMMENT '메뉴 코드' ,
  OPTION_NM VARCHAR(100) COMMENT '옵션명' ,
  OPTION_SIZE INT COMMENT '옵션 개수' ,
  OPTION_CONTENT1 VARCHAR(100),
  OPTION_CONTENT2 VARCHAR(100),
  OPTION_CONTENT3 VARCHAR(100),
  OPTION_CONTENT4 VARCHAR(100),
  OPTION_CONTENT5 VARCHAR(100),
  REG_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록 일시' ,
  CONSTRAINT MENU_OPT_PK PRIMARY KEY (COM_ID,MENU_CD)
) COMMENT ='메뉴 옵션 설정' ;

# 주문
DROP TABLE IF EXISTS DEMAND; 
CREATE TABLE DEMAND
(
  COM_ID VARCHAR(100) NOT NULL COMMENT '업체 아이디' ,
  CUS_ID VARCHAR(100) NOT NULL COMMENT '사용자 아이디' ,
  DEMAND_SEQ VARCHAR(18) NOT NULL COMMENT '주문번호' , # yyyyMMddHHmmssSSS +1 =18자리
  DEMAND_CNT INT COMMENT '주문 개수' ,
  PRICE INT COMMENT '총 가격' ,
  RESERVE_YN VARCHAR(2) COMMENT '예약 여부' ,
  DEMAND_CD VARCHAR(2) COMMENT '식사위치 01,02,03'  , 
  DEMAND_WAY VARCHAR(2) COMMENT '주문방식(웹,어플)' ,
  PAYMENT_CD VARCHAR(2) COMMENT '결제 코드(현금,카드,폰)' ,
  ADDRESS VARCHAR(200) COMMENT '주소' ,
  DTAIL_ADDRESS VARCHAR(100) COMMENT '상세주소' ,
  DEMAND_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '주문 일시' ,
  PAYMENT_YN VARCHAR(2) COMMENT '결제 완료 여부' , # 사용자기준
  SALE_YN VARCHAR(2) COMMENT '판매 완료 여부' , # 매장기준
  PHONE_NUM VARCHAR(20) COMMENT '핸드폰 번호' ,
  REG_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록일시' ,
  CONSTRAINT DEMAND_PK PRIMARY KEY (COM_ID,CUS_ID,DEMAND_SEQ)
) COMMENT ='주문' ;

# 주문 상세 내역
DROP TABLE IF EXISTS DEMAND_DETAIL; 
CREATE TABLE DEMAND_DETAIL
(
  COM_ID VARCHAR(100) NOT NULL COMMENT '업체 아이디' ,
  CUS_ID VARCHAR(100) NOT NULL COMMENT '사용자 아이디' ,
  DEMAND_SEQ VARCHAR(18) NOT NULL COMMENT '주문번호' , # yyyyMMddHHmmssSSS +1 =18자리
  SEQ VARCHAR(8) COMMENT '' , # DEMAND의 CNT값에 따라 1부터 1씩 증가
  MENU_CD VARCHAR(8) COMMENT '메뉴 코드' ,
  MENU_NM VARCHAR(50) COMMENT '메뉴명' ,
  CNT INT COMMENT '메뉴 개수' ,
  REG_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록 일시' ,
  CONSTRAINT DEMAND_DETAIL_PK PRIMARY KEY (COM_ID,CUS_ID,DEMAND_SEQ)
) COMMENT ='주문 상세 내역' ;









# 일반 사용자 정보 테이블
DROP TABLE IF EXISTS MEMBER; 
CREATE TABLE MEMBER
(
  CUS_ID VARCHAR(100) NOT NULL COMMENT '사용자 아이디' ,
  PWD VARCHAR(100) NOT NULL COMMENT '비밀번호' ,
  JOIN_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '가입 일시' ,
  PHONE_NUM VARCHAR(20) COMMENT '핸드폰 번호' ,
  NAME VARCHAR(50) COMMENT '성명' ,
  SEX VARCHAR(1) COMMENT '성별' ,
  BIRTH_DT VARCHAR(8) COMMENT '생년월일' ,
  CI VARCHAR(100) COMMENT 'CI' ,
  DI VARCHAR(100) COMMENT 'DI' ,
  ADDRESS VARCHAR(200) COMMENT '주소' ,
  DTAIL_ADDRESS VARCHAR(100) COMMENT '상세주소' ,
  LEAVE_REASON VARCHAR(500) COMMENT '탈퇴 사유' ,
  LEAVE_DT_TM TIMESTAMP DEFAULT NULL COMMENT '탈퇴 일시' ,
  USE_YN VARCHAR(2) COMMENT '사용 여부' ,
  REG_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록 일시' ,
  CHG_DT_TM TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '변경 일시' ,
  CONSTRAINT COMPANY_PK PRIMARY KEY (CUS_ID)
) COMMENT ='일반 사용자 정보' ;

# 즐겨찾기나 최근매장 정보는 사용자에게 귀속되는 데이터인데
# 이걸 디비에 저장하기엔 무리인듯하니
# 캐시나 다른 방법을 이용해야할듯함.